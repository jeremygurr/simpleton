#!/usr/bin/env bash

setup_log_block_aliases() {

  alias begin_function='
    local return_value=0 break_out=f deep_function=t
    write_to_log_and_save 
    if (( log_depth_current++ )); then :; fi
    log_vars= log_show_vars=
    while true; do
  '

  alias end_function='
    break; done;
  '

  alias handle_return='
    if [[ "${deep_function:-}" ]]; then
      load_log_vars_and_write_to_log
      if (( log_depth_current-- )); then :; fi
    fi
    return $return_value
  '

  alias  begin_function_flat='local return_value=0 break_out=f deep_function; while true; do'
  alias          begin_while='break_out=f; while'
  alias            begin_for='break_out=f; for'
  alias           begin_loop='break_out=f; while true; do'
  alias            end_while='done; [[ $break_out == t ]] && break; true'
  alias              end_for='done; [[ $break_out == t ]] && break; true'
  alias             end_loop='done; [[ $break_out == t ]] && break; true'

  alias handle_exit='exit $return_value'

}

setup_log_block_aliases

