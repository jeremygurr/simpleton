$ mkdir -p test-cube/.dna

$ cube edit test-cube/.dna/context content='
  batch_dims=( env )
  out_path=out

  expand_members_env() {
    local value=$value
    case $value in
      prod)
        new_values=( prod1 prod2 )
      ;;
      dev|prod*)
        new_values=( $value )
      ;;
      all)
        new_values=( dev prod1 prod2 )
      ;;
      *)
        new_values=( )
      ;;
    esac
    return 0
  }

  execute_update() { 
    echo "env=$env" >$batch_out_path/value
  }
  '

$ cell update test-cube env=dev
$ grep 'env=dev' test-cube/.cyto/batch/dim/env/dev/out/value >/dev/null 

$ rm -rf test-cube/.cyto
$ cell update test-cube envs='dev prod1'
$ grep 'env=prod1' test-cube/.cyto/batch/dim/env/prod1/out/value >/dev/null 
$ grep 'env=dev' test-cube/.cyto/batch/dim/env/dev/out/value >/dev/null 

