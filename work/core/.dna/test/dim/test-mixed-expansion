$ mkdir -p test-cube/.dna

$ cube edit test-cube/.dna/context content='
  batch_dims=( env project )
  out_path=out

  expand_member_project() {
    local value=$value
    case $value in
      mw|my-web)
        new_value=my-web
      ;;
      md|my-data)
        new_value=my-data
      ;;
      *)
        new_value=
      ;;
    esac
    return 0
  }

  expand_members_env() {
    local value=$value
    case $value in
      prod)
        new_values=( prod1 prod2 )
      ;;
      dev|prod*)
        new_values=( $value )
      ;;
      all)
        new_values=( dev prod1 prod2 )
      ;;
      *)
        new_values=( )
      ;;
    esac
    return 0
  }

  execute_update() { 
    echo "env=$env project=$project" >$batch_out_path/value
  }
  '

$ cell update test-cube envs=all project=md
$ grep 'env=dev project=my-data' test-cube/.cyto/batch/dim/env/dev/dim/project/my-data/out/value >/dev/null 
$ grep 'env=prod1 project=my-data' test-cube/.cyto/batch/dim/env/prod1/dim/project/my-data/out/value >/dev/null 
$ grep 'env=prod2 project=my-data' test-cube/.cyto/batch/dim/env/prod2/dim/project/my-data/out/value >/dev/null 

